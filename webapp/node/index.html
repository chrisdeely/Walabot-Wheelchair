<!doctype html>
<html>
  <head>
    <title>Walabot Wheelchair</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
      progress {
        border: 0;
         width: 20em;
         height: 5em;
         border-radius: 9px;
      }

      progress.yellow::-webkit-progress-value {
        background-color: yellow;
      }
      progress.red::-webkit-progress-value {
        background-color: red;
      }

    </style>
  </head>
  <body>
    <progress id="meter" class="yellow" max="100" value="0"></progress>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var ALERT = 60,
          socket = io(),
          meter = document.getElementById('meter');

          socket.on('targetData', function(target){
            console.log(target);
            target = JSON.parse(target);
            meter.classList.remove('red', 'yellow');
            meter.value = Math.floor(target.zPosCm);
            if(target.zPosCm <= ALERT){
              meter.classList.add('red')
            }else{
              meter.classList.add('yellow')
            }
          });

          socket.on('noTarget', function(){
            console.log('no targets available');
            meter.value = 0;
          })
    </script>
  </body>
</html>
